<!DOCTYPE html>
<html lang="en">
  <head>

    <!-- MAIN META -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>@jccultima123</title>
    <meta name="description" content="Master of None. Lazy Software Developer" />
    <meta name="keywords" content="one-page, git, portfolio, web-design, repository, page, development, graphql, html5, github-pages" />
    <meta name="author" content="John Cyrill Corsanes" />
    <!-- Theme Color for Chrome's Address bar (Mobile) -->
    <!-- <meta name="theme-color" content="#3E6083"> -->

    <!-- Facebook and Twitter integration -->
    <meta property="og:title" content="JCC - Portfolio Page"/>
    <meta property="og:image" content="img/jcc_logo_og.jpg"/>
    <meta property="og:url" content="jccultima123.github.io"/>
    <meta property="og:site_name" content="My Portfolio - @jccultima123"/>
    <meta property="og:description" content="Master of None. Lazy Software Developer"/>
    <meta name="twitter:title" content="JCC - Portfolio Page" />
    <meta name="twitter:image" content="img/jcc_logo_og.jpg" />
    <meta name="twitter:url" content="jccultima123.github.io" />
    <meta name="twitter:card" content="portfolio" />

    <!-- Bootstrap -->
    <script src="js/modernizr.custom.js"></script>
    <link href="css/animate.css" rel="stylesheet">

    <!-- CDN -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"> -->
    <!-- <link href='https://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'> -->

    <!-- NES.css -->
    <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
    <link href="https://unpkg.com/nes.css@2.0.0/css/nes.min.css" rel="stylesheet" />
    <!-- <link href="./style.css" rel="stylesheet" /> -->

    <!-- Polyfill -->
    <link rel="stylesheet" href="css/dialog-polyfill.css">

    <!-- Others -->
    <link href="css/custom.css" rel="stylesheet">
    <link href="css/media.css" rel="stylesheet">

    <!-- <meta http-equiv="X-Frame-Options" content="deny"> -->
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>
  <body>

    <!--[if lt IE 7]>
    <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#" data-href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

    <div id="app"></div>
    <!-- built files will be auto injected -->

    <!-- redirect hidden elem -->
    <a id="redirect" target="_blank" href="#" hidden></a>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

    <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
    <script>
    (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
    function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
    e=o.createElement(i);r=o.getElementsByTagName(i)[0];
    e.src='https://www.google-analytics.com/analytics.js';
    r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
    ga('create','UA-53297367-3');ga('send','pageview');
    </script>

    <!-- GITHUB -->
    <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

    <!-- Polyfill -->
    <script async src="js/dialog-polyfill.js"></script>

    <script>

      /** main */
      window.onload = function () {

        // document.getElementById("#loading-dialog").showModal();
        $("#main-container").removeAttr("hidden");

        /**
         * Micro Client processor
         */
        const microProcessor = {
          init: function () {
            return $.ajax({
              url: "https://jcc-portfolio-api.herokuapp.com/graphql",
              contentType: "application/json",
              type: "POST",
              data: JSON.stringify({
                query: `{
                  allPost {
                    id
                    title
                    description
                    createdAt
                  }
                }`
              }),
              timeout: 2000,
              success: function (result) {
                let data = result.data // get data from graphql
                let post = data.allPost // query name
                // console.log(post.length);
                let li = "";
                for (let i = 0; i < post.length; i++) {
                  p = post[i];
                  li += '<div id="post-' + p.id + '" class="post-list nes-container with-title is-centered">' +
                      '<p class="post-title">'+p.title+'</p>' +
                      '<p class="post-sentence">'+p.description+'</p>' +
                    '</div>';
                }
                if (post.length > 0) {
                  $("#all-post").html(li);
                  $('#update-container').show();
                }
                console.log('done loading posts..');

                // finish
                microProcessor.finishSetup();
              },
              error: function () {
                $("#all-post").html('');
                // $('#update-container').hide();

                console.log('error loading posts..');
                // render anyway
                microProcessor.finishSetup();
              }
            });
          },
          finishSetup: function() {
            $('#loading-dialog').hide();
            $('#profile-container').show();
          }
        }

        // set
        microUpdates = microProcessor;

        if ($('.too-small-warning').is(':hidden')) {
          // $('#profile-container').show();
          if ($('#profile-container').is(':hidden')) {
            // load posts first
            $('#loading-message').text('Loading updates...');
            // load updates
            microUpdates.init();
          }
        } else {
          // Skip animation
          // $('#dialog').hide();
          $('#profile-container').show();
        }
      }

      function goToUrl(url, includeTarget = true) { //eslint-disable-line no-unused-vars
        $('#redirect').attr('href', url);
        if (!includeTarget) {
          $('#redirect').attr('target', null);
        } else {
          $('#redirect').attr('target', '_blank');
        }
        $('#redirect')[0].click();
      }

    </script>

    <script src="js/daynighttime.js"></script>

  </body>
</html>
